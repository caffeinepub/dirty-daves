{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Configure ICP custom domain verification static assets and update production docs",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Serve /.well-known/ic-domains with exactly two domain lines (apex + www) from frontend/public for ICP custom domain verification.",
      "acceptanceCriteria": [
        "Repository contains `frontend/public/.well-known/ic-domains`.",
        "`frontend/public/.well-known/ic-domains` content matches exactly:\n`dirtydaves.co.uk\\nwww.dirtydaves.co.uk` (newline-separated, no additional newline at end preferred).",
        "When deployed, `GET /.well-known/ic-domains` returns HTTP 200 and the response body is exactly those two lines."
      ],
      "file_operations": [
        {
          "path": "frontend/public/.well-known/ic-domains",
          "operation": "modify",
          "description": "Update file contents to be exactly two lines with no extra spaces/quotes and no trailing blank line: first line `dirtydaves.co.uk`, second line `www.dirtydaves.co.uk`."
        }
      ]
    },
    {
      "id": "REQ-2",
      "summary": "Serve /.well-known/ii-alternative-origins as a static one-line JSON file for Internet Identity alternative origins.",
      "acceptanceCriteria": [
        "Repository contains `frontend/public/.well-known/ii-alternative-origins`.",
        "File content matches exactly the provided JSON on a single line.",
        "When deployed, `GET /.well-known/ii-alternative-origins` returns HTTP 200."
      ],
      "file_operations": [
        {
          "path": "frontend/public/.well-known/ii-alternative-origins",
          "operation": "create",
          "description": "Create a no-extension static asset containing exactly this single line (no trailing newline): {\"alternativeOrigins\":[\"https://dirtydaves.co.uk\",\"https://www.dirtydaves.co.uk\"]}."
        }
      ]
    },
    {
      "id": "REQ-3",
      "summary": "Add .ic-assets.json to set explicit content types and disable caching (max_age 0) for the two /.well-known assets.",
      "acceptanceCriteria": [
        "Repository contains `frontend/public/.ic-assets.json` with the exact JSON provided in the request (paths, content_type values, and cache.max_age).",
        "On deployment, responses for `/.well-known/ic-domains` and `/.well-known/ii-alternative-origins` are served with appropriate `Content-Type` and are not aggressively cached (max-age 0)."
      ],
      "file_operations": [
        {
          "path": "frontend/public/.ic-assets.json",
          "operation": "create",
          "description": "Create the asset configuration file with exactly the JSON structure and paths specified in the request to set content_type and cache.max_age: 0 for `/.well-known/ic-domains` and `/.well-known/ii-alternative-origins`."
        }
      ]
    },
    {
      "id": "REQ-4",
      "summary": "Update production smoke test doc to expect the new ic-domains two-line content and to verify ii-alternative-origins payload.",
      "acceptanceCriteria": [
        "`frontend/SMOKE_TEST_PRODUCTION.md` section \"Custom Domain Verification\" expects `dirtydaves.co.uk` and `www.dirtydaves.co.uk` (and no extra lines).",
        "Smoke test includes a step to fetch and verify `/.well-known/ii-alternative-origins` content."
      ],
      "file_operations": [
        {
          "path": "frontend/SMOKE_TEST_PRODUCTION.md",
          "operation": "modify",
          "description": "Revise the \"Custom Domain Verification\" section to expect exactly two lines for `/.well-known/ic-domains` (including `www`) and add a new check to fetch `/.well-known/ii-alternative-origins` and verify it matches exactly {\"alternativeOrigins\":[\"https://dirtydaves.co.uk\",\"https://www.dirtydaves.co.uk\"]}."
        }
      ]
    },
    {
      "id": "REQ-5",
      "summary": "Add post-deploy checklist note documenting remaining manual custom-domain setup steps (DNS + optional registration/status URLs) for canister fd6rd-maaaa-aaaah-atocq-cai.",
      "acceptanceCriteria": [
        "A production/deployment documentation file includes the user-provided DNS records verbatim:\n- CNAME @/apex → dirtydaves.co.uk.icp1.io\n- CNAME www → www.dirtydaves.co.uk.icp1.io\n- TXT _canister-id.dirtydaves.co.uk → fd6rd-maaaa-aaaah-atocq-cai\n- CNAME _acme-challenge.dirtydaves.co.uk → _acme-challenge.dirtydaves.co.uk.icp2.io\n(and note about www if needed).",
        "Documentation includes verbatim optional commands/URLs:\n- `curl -sL -X POST https://icp0.io/custom-domains/v1/dirtydaves.co.uk`\n- `https://icp0.io/custom-domains/v1/dirtydaves.co.uk` for status."
      ],
      "file_operations": [
        {
          "path": "frontend/PRODUCTION_DEPLOYMENT_NOTES.md",
          "operation": "modify",
          "description": "Add a short post-deploy checklist note for canister `fd6rd-maaaa-aaaah-atocq-cai` listing the remaining manual steps outside Caffeine, including the DNS records verbatim (CNAME @/apex → dirtydaves.co.uk.icp1.io; CNAME www → www.dirtydaves.co.uk.icp1.io; TXT _canister-id.dirtydaves.co.uk → fd6rd-maaaa-aaaah-atocq-cai; CNAME _acme-challenge.dirtydaves.co.uk → _acme-challenge.dirtydaves.co.uk.icp2.io; plus the note about www if needed) and the optional registration/status command and URL verbatim (`curl -sL -X POST https://icp0.io/custom-domains/v1/dirtydaves.co.uk` and `https://icp0.io/custom-domains/v1/dirtydaves.co.uk`)."
        }
      ]
    }
  ]
}